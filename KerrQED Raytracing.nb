(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     99250,       2461]
NotebookOptionsPosition[     97646,       2425]
NotebookOutlinePosition[     98057,       2442]
CellTagsIndexPosition[     98014,       2439]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "m", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\:53c2\:6570parameters", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"2", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qm", "=", 
   RowBox[{"5", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9068974380555925`*^9, 3.9068974389310617`*^9}, {
   3.9069791643211145`*^9, 3.9069791650912523`*^9}, {3.9069829869298897`*^9, 
   3.9069830041901026`*^9}, 3.9069886628786564`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"ceea9b0f-67c1-4788-9270-08c2bc1abb7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:5ea6\:89c4Metric", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{
      FractionBox["2", "Pi"], " ", "\[Mu]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", "r_", "]"}], ":=", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["Qm", "2"], 
       RowBox[{"2", "r"}]], "+", 
      FractionBox[
       RowBox[{"A", " ", 
        SuperscriptBox["Qm", "4"]}], 
       RowBox[{"40", 
        SuperscriptBox["r", "5"]}]]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalSigma]", "=", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", "=", 
     RowBox[{
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", 
       RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
      SuperscriptBox["a", "2"]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"m", "[", "r", "]"}], "r"}], ")"}], "/", 
             "\[CapitalSigma]"}]}], ")"}]}], ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "\[CapitalSigma]"}], ")"}]}], "2", " ", "a", 
          " ", 
          RowBox[{"m", "[", "r", "]"}], "r", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"\[CapitalSigma]", "/", "\[CapitalDelta]"}], ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "\[CapitalSigma]", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "\[CapitalSigma]"}], ")"}]}], "2", " ", "a", 
          " ", 
          RowBox[{"m", "[", "r", "]"}], "r", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", "0", ",", "0", 
         ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["a", "2"], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "\[CapitalSigma]"}], ")"}], "2", " ", 
             RowBox[{"m", "[", "r", "]"}], 
             SuperscriptBox["a", "2"], "r", " ", 
             SuperscriptBox[
              RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], "}"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{"g_", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\\", "mu"}], "\\n", "u"}], "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Ig", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                SuperscriptBox["r", "2"]}], ")"}], "2"], "-", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["a", "2"], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
                SuperscriptBox["r", "2"]}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
             SuperscriptBox["r", "2"]}], ")"}]}]], ",", "0", ",", "0", ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "a", " ", 
            RowBox[{"m", "[", "r", "]"}], "r"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "2"], "+", 
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            RowBox[{"2", " ", 
             RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
            SuperscriptBox["r", "2"]}], ")"}], 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]], ",", "0", ",", 
         "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["r", "2"], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]], ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "a", " ", 
            RowBox[{"m", "[", "r", "]"}], "r"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r", "2"], "+", 
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["a", "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
              SuperscriptBox["r", "2"]}], ")"}]}]]}], ",", "0", ",", "0", ",", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
             SuperscriptBox["r", "2"]}], ")"}], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "-", 
             RowBox[{"2", " ", 
              RowBox[{"m", "[", "r", "]"}], "r"}], "+", 
             SuperscriptBox["r", "2"]}], ")"}], 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]}], "}"}]}], 
      "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"g", "^", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\\", "mu"}], "\\n", "u"}], "}"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"\:7535\:78c1\:573aElectroMagnetic", " ", "Field"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"F01", "=", 
     RowBox[{
      RowBox[{"-", "Qm"}], 
      FractionBox[
       RowBox[{"2", "a", " ", "r", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "2"]]}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"F02", "=", 
     RowBox[{
      RowBox[{"-", "Qm"}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "a", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "2"]]}]}],
     ";"}], "\n", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "F01", ",", "F02", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "F01"}], ",", "0", ",", "0", ",", 
         RowBox[{"F01", " ", "a", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "F02"}], ",", "0", ",", "0", ",", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["a", "2"]}], "a"], "F02"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "F01"}], " ", "a", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["r", "2"], "+", 
             SuperscriptBox["a", "2"]}], "a"]}], "F02"}], ",", "0"}], "}"}]}],
       "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"F_", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\\", "mu"}], "\\n", "u"}], "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"trF", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["F01", "2"], "-", 
         FractionBox[
          SuperscriptBox["F02", "2"], 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]]}], ")"}]}], "//", 
      "Simplify"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\\", "mathcal"}], 
     RowBox[{"{", "F", "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"trG", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], 
       FractionBox[
        RowBox[{"F01", " ", "F02"}], 
        RowBox[{"a", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]]}], "//", "Simplify"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\\", "mathcal"}], 
     RowBox[{"{", "G", "}"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"FF", "=", 
     RowBox[{"-", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Ig", ".", 
        RowBox[{"Simplify", "[", 
         RowBox[{"F", ".", 
          RowBox[{"Simplify", "[", 
           RowBox[{"Ig", ".", "F", ".", "Ig"}], "]"}]}], "]"}]}], "]"}]}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "^", 
       RowBox[{"{", 
        RowBox[{"\\", "mu", "\\", "alpha"}], "}"}]}], 
      RowBox[{"F", "^", "\\n"}], 
      RowBox[{"u", "\\"}]}], ",", 
     RowBox[{"_", "\\", "alpha"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:6709\:6548\:5ea6\:89c4\:548c\:54c8\:5bc6\:987f\:91cfthe", " ", 
     "Effective", " ", "Metric", " ", "and", " ", "Hamiltonian"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"\[CapitalOmega]1", "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"7", "\[Mu]"}], "8"], ")"}], "2"], " ", 
      FractionBox["trG", 
       RowBox[{"4", "Pi"}]]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalOmega]2", "=", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", "\[Mu]"}], "32"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"17", 
          SuperscriptBox["\[Mu]", "2"]}], "16"], ")"}], 
       FractionBox["trF", 
        RowBox[{"4", "Pi"}]]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalOmega]3", "=", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Mu]", "2"], ")"}], "2"]}], 
      FractionBox["trG", 
       RowBox[{"4", "Pi"}]]}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[CapitalOmega]plus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"2", "\[CapitalOmega]1"}]]}], 
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]2", "-", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[CapitalOmega]2", "2"], "-", 
             RowBox[{"4", "\[CapitalOmega]1", " ", "\[CapitalOmega]3"}]}], 
            ")"}]}]}], ")"}]}], "//", "Simplify"}]}], ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[CapitalOmega]minus", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"2", "\[CapitalOmega]1"}]]}], 
       RowBox[{"(", 
        RowBox[{"\[CapitalOmega]2", "+", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[CapitalOmega]2", "2"], "-", 
            RowBox[{"4", "\[CapitalOmega]1", " ", "\[CapitalOmega]3"}]}], 
           ")"}]}]}], ")"}]}], "//", "Simplify"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Kplus", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "4"]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Mu]", " "}], 
            RowBox[{"8", "Pi"}]], "trF"}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"7", "\[Mu]"}], 
            RowBox[{"32", "Pi"}]], "\[CapitalOmega]plus", "*", "trG"}]}], 
         ")"}], "*", "Ig"}], "+", 
       RowBox[{
        FractionBox["\[Mu]", 
         RowBox[{"2", "Pi"}]], "*", "FF"}]}]}], ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Kminus", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "4"]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Mu]", " "}], 
            RowBox[{"8", "Pi"}]], "trF"}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"7", "\[Mu]"}], 
            RowBox[{"32", "Pi"}]], "\[CapitalOmega]minus", "*", "trG"}]}], 
         ")"}], "*", "Ig"}], "+", 
       RowBox[{
        FractionBox["\[Mu]", 
         RowBox[{"2", "Pi"}]], "*", "FF"}]}], "//", "Simplify"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"IK", "=", 
     RowBox[{"Inverse", "[", "Kminus", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"QQ", "=", 
     RowBox[{"{", 
      RowBox[{"qt", ",", "qr", ",", "q\[Theta]", ",", "q\[Phi]"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"H", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"7", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Kminus", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"QQ", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"QQ", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}]}]}], 
    ";"}], "\n", 
   RowBox[{"(*", "\:8fd0\:52a8\:65b9\:7a0bEoM", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"du", "=", 
     RowBox[{"{", 
      RowBox[{
      "td", ",", "rd", ",", "\[Theta]d", ",", "\[Phi]d", ",", "qrd", ",", 
       "q\[Theta]d"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"td", "=", 
     RowBox[{"D", "[", 
      RowBox[{"H", ",", "qt"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rd", "=", 
     RowBox[{"D", "[", 
      RowBox[{"H", ",", "qr"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Theta]d", "=", 
     RowBox[{"D", "[", 
      RowBox[{"H", ",", "q\[Theta]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Phi]d", "=", 
     RowBox[{"D", "[", 
      RowBox[{"H", ",", "q\[Phi]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"qrd", "=", 
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"H", ",", "r"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"q\[Theta]d", "=", 
     RowBox[{"-", 
      RowBox[{"D", "[", 
       RowBox[{"H", ",", "\[Theta]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Deom", "=", 
     RowBox[{"du", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"qt", "\[Rule]", 
         RowBox[{"-", "EE"}]}], ",", 
        RowBox[{"q\[Phi]", "\[Rule]", " ", "LL"}], ",", 
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"qr", "\[Rule]", " ", 
         RowBox[{"qr", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"q\[Theta]", "\[Rule]", " ", 
         RowBox[{"q\[Theta]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"\\", "delta"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Delta]1", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Mu]", " ", "trF"}], 
       RowBox[{"4", "Pi"}]], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"\[Delta]2", "=", 
     RowBox[{
      FractionBox[
       RowBox[{"7", "\[Mu]", " ", 
        RowBox[{"trG", "^", "2"}]}], 
       RowBox[{"16", "Pi", " ", "trF"}]], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"\[Delta]3", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "  ", 
           SuperscriptBox["Qm", "2"], " ", "\[Mu]", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "10"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "10"]}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["a", "8"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "8"], " ", 
              SuperscriptBox["r", "2"]}], "+", 
             RowBox[{"14", " ", 
              SuperscriptBox["a", "6"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "6"], " ", 
              SuperscriptBox["r", "4"]}], "+", 
             RowBox[{"44", " ", 
              SuperscriptBox["a", "4"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "4"], " ", 
              SuperscriptBox["r", "6"]}], "+", 
             RowBox[{"17", " ", 
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox[
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
              SuperscriptBox["r", "8"]}], "+", 
             RowBox[{"30", " ", 
              SuperscriptBox["r", "10"]}]}], ")"}]}], " ", ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "\[Pi]", " ", 
              SuperscriptBox["r", "4"]}], "-", 
             RowBox[{
              SuperscriptBox["Qm", "2"], " ", "\[Mu]"}]}], ")"}]}], ")"}]}], 
        ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"\[Delta]4", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["Qm", "2"], " ", "\[Mu]", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"12", " ", 
            SuperscriptBox["r", "12"]}], "+", 
           RowBox[{"95", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["r", "10"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
           RowBox[{"82", " ", 
            SuperscriptBox["a", "4"], " ", 
            SuperscriptBox["r", "8"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "4"]}], "+", 
           RowBox[{"82", " ", 
            SuperscriptBox["a", "6"], " ", 
            SuperscriptBox["r", "6"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "6"]}], "+", 
           RowBox[{"48", " ", 
            SuperscriptBox["a", "8"], " ", 
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "8"]}], "+", 
           RowBox[{"15", " ", 
            SuperscriptBox["a", "10"], " ", 
            SuperscriptBox["r", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "10"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "12"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "12"]}]}], ")"}]}], ")"}],
        "/", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}], "6"], 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", "A", " ", 
            SuperscriptBox["Qm", "2"], " ", 
            SuperscriptBox["r", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["r", "6"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", "A", " ", 
            SuperscriptBox["Qm", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], 
        ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"\[Delta]5", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
           SuperscriptBox["Qm", "2"], " ", "\[Mu]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox[
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
              SuperscriptBox["r", "2"]}], ")"}], "6"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "20"}], " ", 
              SuperscriptBox["\[Pi]", "2"], " ", 
              SuperscriptBox["r", "8"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["a", "2"]}], "+", 
                SuperscriptBox["Qm", "2"], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "r"}]}], 
               ")"}]}], "+", 
             RowBox[{"4", " ", "\[Pi]", " ", 
              SuperscriptBox["Qm", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"5", " ", 
                 SuperscriptBox["a", "4"], " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", 
                RowBox[{"5", " ", 
                 SuperscriptBox["a", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox[
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], " ", 
                 SuperscriptBox["r", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["r", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", 
                    SuperscriptBox["Qm", "2"]}], "+", 
                   RowBox[{"5", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
              " ", "\[Mu]"}], "-", 
             RowBox[{
              SuperscriptBox["Qm", "6"], " ", 
              SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", " ", 
          SuperscriptBox["a", "14"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "12"], " ", "\[Pi]", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{"20", " ", 
          SuperscriptBox["a", "12"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "10"], " ", 
          RowBox[{"(", 
           RowBox[{"8", "+", 
            SuperscriptBox[
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], " ", 
          "\[Pi]", " ", 
          SuperscriptBox["r", "4"]}], "+", 
         RowBox[{"60", " ", "\[Pi]", " ", 
          SuperscriptBox["r", "14"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5", " ", 
             SuperscriptBox["Qm", "2"]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "10"}], "+", 
               RowBox[{"7", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"30", " ", 
          SuperscriptBox["Qm", "4"], " ", 
          SuperscriptBox["r", "10"], " ", "\[Mu]"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["r", "8"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"420", " ", "\[Pi]", " ", 
             SuperscriptBox["r", "6"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "\[Pi]", " ", 
                SuperscriptBox["r", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"17", " ", 
                   SuperscriptBox["Qm", "2"]}], "+", 
                  RowBox[{"2", " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "17"}], "+", 
                    RowBox[{"56", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{"17", " ", 
                SuperscriptBox["Qm", "4"], " ", "\[Mu]"}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["a", "4"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
          SuperscriptBox["r", "6"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"280", " ", "\[Pi]", " ", 
             SuperscriptBox["r", "6"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", " ", "\[Pi]", " ", 
                SuperscriptBox["r", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"22", " ", 
                   SuperscriptBox["Qm", "2"]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "44"}], "+", 
                    RowBox[{"63", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{"11", " ", 
                SuperscriptBox["Qm", "4"], " ", "\[Mu]"}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "6"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "4"], " ", 
          SuperscriptBox["r", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"630", " ", "\[Pi]", " ", 
             SuperscriptBox["r", "6"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "\[Pi]", " ", 
                SuperscriptBox["r", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"7", " ", 
                   SuperscriptBox["Qm", "2"]}], "+", 
                  RowBox[{"2", " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "7"}], "+", 
                    RowBox[{"24", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{"7", " ", 
                SuperscriptBox["Qm", "4"], " ", "\[Mu]"}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "10"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "8"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"540", " ", "\[Pi]", " ", 
             SuperscriptBox["r", "6"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "\[Pi]", " ", 
                SuperscriptBox["r", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Qm", "2"], "+", 
                  RowBox[{"2", " ", "r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"8", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{
                SuperscriptBox["Qm", "4"], " ", "\[Mu]"}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["a", "8"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "6"], " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"160", " ", "\[Pi]", " ", 
             SuperscriptBox["r", "6"]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", " ", "\[Pi]", " ", 
                SuperscriptBox["r", "4"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Qm", "2"], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"9", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
               RowBox[{
                SuperscriptBox["Qm", "4"], " ", "\[Mu]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "\[Rule]", " ", 
         RowBox[{"t", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"r", "\[Rule]", " ", 
         RowBox[{"r", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", " ", 
         RowBox[{"\[Theta]", "[", "\[Lambda]", "]"}]}], ",", 
        RowBox[{"\[Phi]", "\[Rule]", " ", 
         RowBox[{"\[Phi]", "[", "\[Lambda]", "]"}]}]}], "}"}]}]}], ";"}], 
   "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<-------------------------------Done \
1-------------------------------------------\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.9068182865625253`*^9, {3.906818625980817*^9, 3.906818728201844*^9}, {
   3.906819671196334*^9, 3.9068196929326787`*^9}, 3.906820041883335*^9, {
   3.9068387566642475`*^9, 3.906838760442031*^9}, {3.906844084974009*^9, 
   3.906844106103628*^9}, {3.906895505531154*^9, 3.9068955112891564`*^9}, {
   3.906895673031433*^9, 3.906895675503132*^9}, 3.906896025630791*^9, {
   3.9068960922766404`*^9, 3.906896115024226*^9}, {3.9068974206091847`*^9, 
   3.9068974243254595`*^9}, 3.9068978427852063`*^9, 3.9069829765552974`*^9, {
   3.906988248484498*^9, 3.906988249017742*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"13e6ae97-dbcb-4c58-945d-b8e0e5b9f81f"],

Cell[BoxData["\<\"-------------------------------Done \
1-------------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.906987513443359*^9, 3.906988843474317*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[6]:=",ExpressionUUID->"c468abbf-fd18-4f78-b80d-\
c59ad6e37485"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:5b9a\:4e49Kerr\:5ea6\:89c4", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "MetricDown", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricDown", "[", 
      RowBox[{"{", 
       RowBox[{"t_", ",", "r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "}"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tt", ",", "rr", ",", "\[Theta]\[Theta]", ",", "\[Phi]\[Phi]", ",", 
         "t\[Phi]", ",", "\[CapitalSigma]", ",", "\[CapitalDelta]"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalSigma]", "=", 
         RowBox[{
          SuperscriptBox["r", "2"], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]", "=", 
         RowBox[{
          SuperscriptBox["r", "2"], "-", 
          RowBox[{"2", 
           RowBox[{"m", "[", "r", "]"}], " ", "r"}], "+", 
          SuperscriptBox["a", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt", "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"2", " ", 
              RowBox[{"m", "[", "r", "]"}], " ", "r"}], "\[CapitalSigma]"]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rr", "=", 
         FractionBox["\[CapitalSigma]", "\[CapitalDelta]"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]\[Theta]", "=", "\[CapitalSigma]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]\[Phi]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["r", "2"], "+", 
            SuperscriptBox["a", "2"], "+", 
            FractionBox[
             RowBox[{"2", " ", 
              RowBox[{"m", "[", "r", "]"}], 
              SuperscriptBox["a", "2"], "r", " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
             "\[CapitalSigma]"]}], ")"}], 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t\[Phi]", "=", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", "a", " ", 
            RowBox[{"m", "[", "r", "]"}], "r", " ", 
            SuperscriptBox[
             RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
           "\[CapitalSigma]"]}]}], ";", "\[IndentingNewLine]", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"tt", "0", "0", "t\[Phi]"},
            {"0", "rr", "0", "0"},
            {"0", "0", "\[Theta]\[Theta]", "0"},
            {"t\[Phi]", "0", "0", "\[Phi]\[Phi]"}
           },
           GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\:628a\[Theta]\:53d8\:52300", "~", "\[Pi]"}], "\:ff0c", 
     RowBox[{
      RowBox[{"\:628a\[Psi]\:53d8\:52300", "~", "2"}], "\[Pi]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "WrapAngle", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WrapAngle", "[", 
      RowBox[{"a1_", ",", "a2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "=", "a1"}], ",", 
         RowBox[{"x2", "=", "a2"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"x1", ">", "\[Pi]"}], ",", 
          RowBox[{"x1", "=", 
           RowBox[{"x1", "-", 
            RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"x1", "<", 
           RowBox[{"-", "\[Pi]"}]}], ",", 
          RowBox[{"x1", "=", 
           RowBox[{"x1", "+", 
            RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x1", "<", "0"}], ",", 
          RowBox[{
           RowBox[{"x1", "=", 
            RowBox[{"-", "x1"}]}], ";", 
           RowBox[{"x2", "=", 
            RowBox[{"x2", "+", "\[Pi]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"x2", "\[GreaterEqual]", 
           RowBox[{"2", "\[Pi]"}]}], ",", 
          RowBox[{"x2", "=", 
           RowBox[{"x2", "-", 
            RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"x2", "<", "0"}], ",", 
          RowBox[{"x2", "=", 
           RowBox[{"x2", "+", 
            RowBox[{"2", "\[Pi]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "ZAMO\:6807\:67b6\:573a", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "LocalTetrads", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LocalTetrads", "[", 
      RowBox[{"pos_", ",", "metric_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "e0", ",", "e1", ",", "e2", ",", "e3", ",", "gtt", ",", "grr", ",", 
         "g\[Theta]\[Theta]", ",", "g\[Phi]\[Phi]", ",", "gt\[Phi]"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "gtt", ",", "grr", ",", "g\[Theta]\[Theta]", ",", "g\[Phi]\[Phi]", 
           ",", "gt\[Phi]"}], "}"}], "=", 
         RowBox[{"Extract", "[", 
          RowBox[{"metric", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e0", "=", 
         RowBox[{
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"g\[Phi]\[Phi]", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"gtt", " ", "g\[Phi]\[Phi]"}], "-", 
                 RowBox[{"gt\[Phi]", " ", "gt\[Phi]"}]}], ")"}]}], ")"}]}], 
            ")"}]}], 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"gt\[Phi]", "/", "g\[Phi]\[Phi]"}], ")"}]}]}], 
           "}"}]}]}], ";", 
        RowBox[{"(*", 
         SubscriptBox["e", "t"], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"e1", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", "grr"}], ")"}]}], ")"}]}], ",", "0", ",", 
           "0"}], "}"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"-", 
          SubscriptBox["e", "r"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"e2", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"\[Sqrt]", "g\[Theta]\[Theta]"}], ")"}]}], ",", "0"}], 
          "}"}]}], ";", 
        RowBox[{"(*", 
         SubscriptBox["e", "\[Theta]"], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"e3", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", "g\[Phi]\[Phi]"}], ")"}]}], ")"}]}]}], 
          "}"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"-", 
          SubscriptBox["e", "\[Phi]"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"e0", ",", "e1", ",", "e2", ",", "e3"}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:5f97\:5230\:5149\:7ebf\:7684\:521d\:59cb\:65b9\:5411\:4ee5\:53ca\
\:76f8\:5bf9\:5e94\:7684\:4e0a\:6807\:56db\:901f\:5ea6", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "GetIniMomentum", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GetIniMomentum", "[", 
       RowBox[{"metric_", ",", "pos_", ",", "fov_", ",", "npix_"}], "]"}], 
      "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Lambda]dot", ",", "xscr", ",", "yscr", ",", "\[Theta]x", ",", 
         "\[Psi]x", ",", "vel", ",", "e0", ",", "e1", ",", "e2", ",", "e3", 
         ",", "\[Kappa]", ",", "momentum", ",", "IKn"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xscr", ",", "yscr"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{
               RowBox[{"Tan", "[", 
                RowBox[{"fov", "/", "2"}], "]"}], "/", "npix"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"npix", "+", "1"}], ")"}]}]}], ")"}]}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]x", ",", "\[Psi]x"}], "}"}], "=", 
         RowBox[{"WrapAngle", "[", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"ArcTan", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["xscr", "2"], "+", 
                  SuperscriptBox["yscr", "2"]}], ")"}]}], ")"}], "/", "2"}], 
             "]"}]}], ",", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             RowBox[{"-", "yscr"}], ",", 
             RowBox[{"-", "xscr"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vel", "=", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]x", "]"}], 
             RowBox[{"Cos", "[", "\[Psi]x", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]x", "]"}], 
             RowBox[{"Sin", "[", "\[Psi]x", "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"e0", ",", "e1", ",", "e2", ",", "e3"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"LocalTetrads", "[", 
           RowBox[{"pos", ",", "metric"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]dot", "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"vel", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "e1"}], "+", 
            RowBox[{
             RowBox[{"vel", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "e2"}], "+", 
            RowBox[{
             RowBox[{"vel", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "e3"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IKn", "=", 
         RowBox[{"IK", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "\[Rule]", " ", 
             RowBox[{"pos", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"r", "\[Rule]", 
             RowBox[{"pos", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\[Theta]", "\[Rule]", " ", 
             RowBox[{"pos", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{"\[Phi]", "\[Rule]", 
             RowBox[{"pos", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "\:672b\:6001\:56db\:901f\:5ea6\:7684\:7a7a\:95f4\:5206\:91cf", ",", 
          RowBox[{"\:65f6\:95f4\:5206\:91cf\[Kappa]", ">", 
           RowBox[{"0", 
            RowBox[{"(", "\:6307\:5411\:672a\:6765", ")"}]}]}], "\:ff0c", 
          "\:5177\:4f53\:5927\:5c0f\:7531\:56db\:901f\:5ea6\:6a21\:65b9\:7b49\
\:4e8e0\:786e\:5b9a"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Kappa]", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"e0", ".", "IKn", ".", "e0"}]], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"e0", ".", "IKn", ".", "\[Lambda]dot"}]}], "+", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"e0", ".", "IKn", ".", "\[Lambda]dot"}], ")"}], "2"],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"e0", ".", "IKn", ".", "e0"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"\[Lambda]dot", ".", "IKn", ".", "\[Lambda]dot"}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Kappa]", "<", "0"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<\:76f8\:673a\:8ddd\:9ed1\:6d1e\:8fc7\:8fd1Too close to the \
black hole\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]dot", "=", 
         RowBox[{
          RowBox[{"\[Kappa]", " ", "e0"}], "+", "\[Lambda]dot"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"momentum", "=", 
         RowBox[{"IKn", ".", "\[Lambda]dot"}]}], ";", "\[IndentingNewLine]", 
        "momentum"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:6570\:503c\:6c42\:89e3\:5355\:6761\:5149\:7ebf\:7684\:65b9\:7a0b",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "TraceSingleRay", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceSingleRay", "[", 
      RowBox[{"pos_", ",", "fov_", ",", "npix_"}], "]"}], "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]F", "=", "3000"}], ",", "eqns", ",", "E0", ",", 
        "L0", ",", "idata", ",", "initialConditions", ",", "sol", ",", 
        "frame", ",", "momentum", ",", "eom", ",", "data", ",", "tag", ",", 
        "rF", ",", "delta"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"momentum", "=", 
        RowBox[{
         RowBox[{"GetIniMomentum", "[", 
          RowBox[{
           RowBox[{"MetricDown", "[", "pos", "]"}], ",", "pos", ",", "fov", 
           ",", "npix"}], "]"}], "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"E0", ",", "L0"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"momentum", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"momentum", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idata", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pos", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"momentum", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"momentum", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initialConditions", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", "[", "0", "]"}], ",", 
            RowBox[{"r", "[", "0", "]"}], ",", 
            RowBox[{"\[Theta]", "[", "0", "]"}], ",", 
            RowBox[{"\[Phi]", "[", "0", "]"}], ",", 
            RowBox[{"qr", "[", "0", "]"}], ",", 
            RowBox[{"q\[Theta]", "[", "0", "]"}]}], "}"}], "==", "idata"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eom", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "'"}], "[", "\[Lambda]", "]"}], ",", 
            RowBox[{
             RowBox[{"r", "'"}], "[", "\[Lambda]", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Theta]", "'"}], "[", "\[Lambda]", "]"}], ",", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "\[Lambda]", "]"}], ",", 
            RowBox[{
             RowBox[{"qr", "'"}], "[", "\[Lambda]", "]"}], ",", 
            RowBox[{
             RowBox[{"q\[Theta]", "'"}], "[", "\[Lambda]", "]"}]}], "}"}], 
          "\[Equal]", "Deom"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqns", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"eom", ",", "initialConditions"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EE", "\[Rule]", " ", "E0"}], ",", 
            RowBox[{"LL", "\[Rule]", " ", "L0"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sol", ",", "data"}], "}"}], "=", 
        RowBox[{"Reap", "[", 
         RowBox[{"NDSolve", "[", 
          RowBox[{"eqns", ",", 
           RowBox[{"{", 
            RowBox[{
            "t", ",", "r", ",", "\[Theta]", ",", "\[Phi]", ",", "qr", ",", 
             "q\[Theta]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]F"}]}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<EventLocator\>\"", ",", " ", 
              RowBox[{"\"\<Event\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"r", "[", "\[Lambda]", "]"}], "-", 
                  RowBox[{"1.01", "horizon"}]}], ",", 
                 RowBox[{
                  RowBox[{"r", "[", "\[Lambda]", "]"}], "-", 
                  RowBox[{"10000", "horizon"}]}]}], "}"}]}], ",", 
              RowBox[{"\"\<EventAction\>\"", "\[RuleDelayed]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Throw", "[", 
                  RowBox[{
                   RowBox[{"\[Lambda]F", " ", "=", 
                    RowBox[{"-", "\[Lambda]"}]}], ",", 
                   "\"\<StopIntegration\>\""}], "]"}], ",", 
                 RowBox[{"Throw", "[", 
                  RowBox[{
                   RowBox[{"\[Lambda]F", " ", "=", 
                    RowBox[{"-", "\[Lambda]"}]}], ",", 
                   "\"\<StopIntegration\>\""}], "]"}]}], "}"}]}]}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"EvaluationMonitor", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Abs", "[", "\[Delta]1", "]"}], "]"}], ",", "del1"}],
                "]"}], ";", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Abs", "[", "\[Delta]2", "]"}], "]"}], ",", "del2"}],
                "]"}], ";", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Abs", "[", "\[Delta]3", "]"}], "]"}], ",", "del3"}],
                "]"}], ";", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Abs", "[", "\[Delta]4", "]"}], "]"}], ",", "del4"}],
                "]"}], ";", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Abs", "[", "\[Delta]5", "]"}], "]"}], ",", "del5"}],
                "]"}]}], ")"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rF", "=", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"-", "\[Lambda]F"}], "]"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rF", "<", 
          RowBox[{"3", " ", "horizon"}]}], ",", 
         RowBox[{"tag", "=", "0"}], ",", 
         RowBox[{"tag", "=", "1"}]}], "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{"tag", "=", 
         RowBox[{"1", "\:8868\:793a\:5149\:7ebf\:53ef\:4ee5\:51fa\:5c04"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"delta", "=", 
        RowBox[{"tag", "*", 
         RowBox[{"(", 
          RowBox[{"Max", "/@", "data"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"-", "\[Lambda]F"}], "]"}], ",", 
            RowBox[{"\[Theta]", "[", 
             RowBox[{"-", "\[Lambda]F"}], "]"}], ",", 
            RowBox[{"\[Phi]", "[", 
             RowBox[{"-", "\[Lambda]F"}], "]"}], ",", 
            RowBox[{"qr", "[", 
             RowBox[{"-", "\[Lambda]F"}], "]"}], ",", 
            RowBox[{"q\[Theta]", "[", 
             RowBox[{"-", "\[Lambda]F"}], "]"}], ",", "E0", ",", "L0"}], 
           "}"}], ",", "delta"}], "]"}], "/.", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:641e\:4e00\:4e2a\:8fdb\:5ea6\:6761\:67e5\:770b\:8dd1\:4e86\:591a\
\:5c11", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "MonitorParallelTable", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MonitorParallelTable", "[", 
      RowBox[{"expr_", ",", "npix_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", 
         RowBox[{"iterCount", "=", 
          SuperscriptBox["npix", "2"]}], ",", 
         RowBox[{"progress", "=", "0"}]}], "}"}], ",", "\n", "  ", 
       RowBox[{
        RowBox[{"SetSharedVariable", "[", "progress", "]"}], ";", "\n", "  ", 
        RowBox[{"res", "=", 
         RowBox[{"Monitor", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"progress", "++"}], ";", 
               RowBox[{"expr", "[", 
                RowBox[{"j", ",", "i"}], "]"}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "npix"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "npix"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "i\:5bf9\:5e94\:884c", ",", 
             "\:753b\:56fe\:65f6\:662fy\:5750\:6807", ",", 
             "j\:5bf9\:5e94\:5217", ",", 
             "\:753b\:56fe\:65f6\:662fx\:5750\:6807", "\:3002", 
             "\:4f46\:662fTraceSingleRay\:7684\:53c2\:6570\:4e2d", ",", 
             "\:7b2c\:4e00\:4e2a\:5143\:7d20\:662fx\:5750\:6807", ",", 
             "\:7b2c\:4e8c\:4e2a\:5143\:7d20\:662fy\:5750\:6807", ",", 
             "\:6240\:4ee5\:770b\:8d77\:6765\:6709\:70b9\:5947\:602a"}], 
            "*)"}], "\n", "    ", 
           RowBox[{"Column", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "@", "progress"}], "<>", "\"\< of \>\"", "<>", 
                RowBox[{"ToString", "@", "iterCount"}]}], ",", 
               RowBox[{"ProgressIndicator", "[", 
                RowBox[{"progress", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "iterCount"}], "}"}]}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], "]"}]}], 
        ";", "\n", "  ", 
        RowBox[{"UnsetShared", "[", "progress", "]"}], ";", 
        "\[IndentingNewLine]", "res"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:8dd1\:6240\:6709\:7684\:70b9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "TraceRay", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceRay", "[", 
      RowBox[{"pos_", ",", "fov_", ",", "npix_"}], "]"}], ":=", 
     RowBox[{"MonitorParallelTable", "[", 
      RowBox[{
       RowBox[{"TraceSingleRay", "[", 
        RowBox[{"pos", ",", "fov", ",", "npix"}], "]"}], ",", "npix"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<-------------------------------Done \
2-------------------------------------------\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.840605371966513*^9, 3.8406054015270443`*^9}, {
   3.8406980568976583`*^9, 3.8406980733436527`*^9}, {3.840699798593956*^9, 
   3.8406998108342047`*^9}, {3.845599791271829*^9, 3.8455997953193483`*^9}, {
   3.8456002714611025`*^9, 3.845600367566765*^9}, {3.8456015742819824`*^9, 
   3.845601609820176*^9}, {3.8456016416817603`*^9, 3.8456016484403906`*^9}, {
   3.8456020328696346`*^9, 3.8456021145387435`*^9}, {3.845602149237941*^9, 
   3.845602221419216*^9}, {3.8456022764933453`*^9, 3.8456022787529325`*^9}, {
   3.8456026968142953`*^9, 3.8456026990074234`*^9}, {3.845603500052498*^9, 
   3.8456035048122663`*^9}, {3.845603574835322*^9, 3.8456035812032313`*^9}, {
   3.8456036170519085`*^9, 3.845603640500626*^9}, {3.8456036786048355`*^9, 
   3.8456036927249584`*^9}, {3.8456037476074915`*^9, 
   3.8456037530602727`*^9}, {3.8456042122008677`*^9, 
   3.8456042400460787`*^9}, {3.845604315231803*^9, 3.845604368799898*^9}, {
   3.845604467046265*^9, 3.8456045175075254`*^9}, {3.8456048016218033`*^9, 
   3.8456048296017203`*^9}, {3.8456048686998844`*^9, 
   3.8456048810504484`*^9}, {3.8456051049503655`*^9, 3.845605162934791*^9}, {
   3.8456054162772865`*^9, 3.845605418652278*^9}, {3.845605628070145*^9, 
   3.8456056302014046`*^9}, {3.8456056927207355`*^9, 3.845605695979012*^9}, {
   3.8456111134475527`*^9, 3.8456111575757*^9}, {3.8456117773765473`*^9, 
   3.8456117778741217`*^9}, {3.8456898296423993`*^9, 3.845689851242711*^9}, {
   3.845689893611834*^9, 3.845689899643549*^9}, 3.846720554218576*^9, 
   3.8467208357953005`*^9, {3.8565809709019485`*^9, 3.8565809753029137`*^9}, {
   3.8565812960879745`*^9, 3.8565813259496727`*^9}, {3.862635237097728*^9, 
   3.8626352651064835`*^9}, {3.862635331807788*^9, 3.8626353531064787`*^9}, {
   3.8626379844413533`*^9, 3.862638002320365*^9}, {3.8626380474679317`*^9, 
   3.862638074450159*^9}, 3.8626381092996035`*^9, {3.8626388152886024`*^9, 
   3.8626388193877726`*^9}, 3.8626398417432013`*^9, 3.862862074184637*^9, {
   3.862863695222642*^9, 3.8628636976463966`*^9}, {3.8628731823211727`*^9, 
   3.862873183832823*^9}, {3.862882059256177*^9, 3.8628820616265974`*^9}, {
   3.8628834989833465`*^9, 3.8628835015941706`*^9}, {3.8628841227905436`*^9, 
   3.862884124366212*^9}, {3.862913631736237*^9, 3.8629136322160025`*^9}, {
   3.8629440020104046`*^9, 3.862944005596136*^9}, {3.864967877887437*^9, 
   3.864967922075522*^9}, {3.8649697062550244`*^9, 3.8649697282733145`*^9}, {
   3.864969768313382*^9, 3.8649698274738464`*^9}, {3.865034469120748*^9, 
   3.8650344841621304`*^9}, {3.8650345877998133`*^9, 3.8650346211122875`*^9}, 
   3.8650352923763404`*^9, {3.8651280507222023`*^9, 3.865128080202462*^9}, {
   3.8651281199068055`*^9, 3.86512815379875*^9}, {3.865128219928115*^9, 
   3.8651282596687684`*^9}, {3.8651283966886845`*^9, 3.865128490263854*^9}, {
   3.865128526732522*^9, 3.865128547873973*^9}, {3.865129081074682*^9, 
   3.8651290864293537`*^9}, {3.865129196818868*^9, 3.865129197476471*^9}, {
   3.865129278544055*^9, 3.8651292925184827`*^9}, {3.8651294841009045`*^9, 
   3.8651294941848965`*^9}, {3.865129584639635*^9, 3.865129586026821*^9}, {
   3.8651296925988407`*^9, 3.865129693013473*^9}, {3.8657468208888083`*^9, 
   3.86574688374642*^9}, {3.865746974715329*^9, 3.8657470321584196`*^9}, {
   3.8657472959306726`*^9, 3.865747303068311*^9}, {3.86574735393915*^9, 
   3.8657473673894167`*^9}, {3.865747479775683*^9, 3.86574751151235*^9}, {
   3.8657475537273455`*^9, 3.865747582685279*^9}, {3.865793102834744*^9, 
   3.865793119940237*^9}, 3.8657931534211745`*^9, {3.8657932337551823`*^9, 
   3.865793314795079*^9}, {3.8657935610102406`*^9, 3.865793561611682*^9}, {
   3.8657937330630007`*^9, 3.8657937583207045`*^9}, 3.8658324913037624`*^9, {
   3.9067137051152563`*^9, 3.9067137054543324`*^9}, {3.9067138061500344`*^9, 
   3.906713808510781*^9}, {3.906713980628993*^9, 3.9067140395398517`*^9}, 
   3.9067330724296207`*^9, {3.9067331139662848`*^9, 3.9067331174267693`*^9}, {
   3.9067332685814824`*^9, 3.90673331045763*^9}, {3.906733433152809*^9, 
   3.9067334336920757`*^9}, {3.906733531451481*^9, 3.9067335951360893`*^9}, {
   3.9067364722757607`*^9, 3.9067364946296697`*^9}, {3.906736638318262*^9, 
   3.9067366748793545`*^9}, {3.9067367094796295`*^9, 
   3.9067367181577363`*^9}, {3.9067370732706547`*^9, 
   3.9067372936726856`*^9}, {3.906739006225347*^9, 3.906739036376528*^9}, {
   3.9067392633702965`*^9, 3.9067392739161053`*^9}, 3.90673947716197*^9, 
   3.906739742477374*^9, {3.9067408909841013`*^9, 3.906740969622858*^9}, {
   3.9067443847628584`*^9, 3.90674438816512*^9}, {3.9067454341577787`*^9, 
   3.90674561264174*^9}, 3.906745815264106*^9, {3.906745985562145*^9, 
   3.9067459995112724`*^9}, {3.9067895548027344`*^9, 
   3.9067895635407457`*^9}, {3.90679011305926*^9, 3.906790145420159*^9}, {
   3.90679018613135*^9, 3.906790213353783*^9}, 3.9067904199719596`*^9, {
   3.9067905048463616`*^9, 3.906790504969265*^9}, {3.9067905531697044`*^9, 
   3.9067905541562243`*^9}, 3.9067907388963127`*^9, {3.90679080962539*^9, 
   3.906790809916089*^9}, 3.9067954136550894`*^9, 3.906795452182583*^9, {
   3.9067958820647745`*^9, 3.906796038941208*^9}, {3.9067960826617165`*^9, 
   3.9067961156650977`*^9}, {3.906796147538353*^9, 3.9067962016060147`*^9}, {
   3.906796611528213*^9, 3.9067966574252963`*^9}, {3.9067967256446123`*^9, 
   3.906796744858968*^9}, 3.9067968416100683`*^9, {3.906796903614365*^9, 
   3.906796916697463*^9}, {3.9068036727589273`*^9, 3.90680383032588*^9}, {
   3.906816431777916*^9, 3.9068164319519553`*^9}, {3.9068166847562704`*^9, 
   3.906816756039211*^9}, {3.9068168755457563`*^9, 3.9068168849206076`*^9}, 
   3.9068184120468636`*^9, 3.9068189623962116`*^9, {3.9068198435229645`*^9, 
   3.906819865997867*^9}, {3.9068199472248154`*^9, 3.906819958684759*^9}, 
   3.906820001592369*^9, {3.9068200537466974`*^9, 3.906820108488999*^9}, {
   3.9068201723257484`*^9, 3.906820176640868*^9}, {3.9068266406392975`*^9, 
   3.9068266437246065`*^9}, {3.906826980234781*^9, 3.9068269985451784`*^9}, {
   3.9068282390760927`*^9, 3.9068282866430826`*^9}, {3.9068285044741297`*^9, 
   3.906828511942854*^9}, {3.906828894885731*^9, 3.9068289231189227`*^9}, {
   3.9068292830238624`*^9, 3.9068293303914595`*^9}, {3.9068293626741047`*^9, 
   3.90682940247795*^9}, {3.9068296601478443`*^9, 3.9068296960099335`*^9}, {
   3.9068302827997665`*^9, 3.9068304171903305`*^9}, {3.9068304998770947`*^9, 
   3.90683051284081*^9}, {3.9068305560597644`*^9, 3.9068306828532457`*^9}, {
   3.906830759625802*^9, 3.906830852422784*^9}, {3.906830897388792*^9, 
   3.9068309042223225`*^9}, 3.9068310237063923`*^9, {3.9068313693258886`*^9, 
   3.9068314148453045`*^9}, {3.906832172501036*^9, 3.9068321765692673`*^9}, {
   3.9068323038449993`*^9, 3.9068323466063952`*^9}, {3.906832753010145*^9, 
   3.906832770932541*^9}, {3.9068328221710367`*^9, 3.9068328307888384`*^9}, {
   3.9068328609880047`*^9, 3.9068328643693595`*^9}, {3.906833039241436*^9, 
   3.906833045303768*^9}, {3.9068331957022705`*^9, 3.906833206283579*^9}, {
   3.9068332582181473`*^9, 3.906833295605054*^9}, {3.906833372575922*^9, 
   3.906833374304085*^9}, {3.906833976533233*^9, 3.90683397742509*^9}, {
   3.9068341154999275`*^9, 3.9068341162941465`*^9}, 3.9068356684608107`*^9, {
   3.906837086887302*^9, 3.906837096756921*^9}, {3.906837296352913*^9, 
   3.906837300896763*^9}, {3.906837533891595*^9, 3.906837542416252*^9}, {
   3.9068376895063443`*^9, 3.906837699992402*^9}, {3.906837948406813*^9, 
   3.9068379517133036`*^9}, {3.90683807175992*^9, 3.9068380799351892`*^9}, {
   3.906838172709569*^9, 3.9068381951539435`*^9}, 3.906839308761381*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"94f71393-03cf-4314-a6be-f5aa8a7a2156"],

Cell[BoxData["\<\"-------------------------------Done \
2-------------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.906832602844501*^9, 3.9068328336986213`*^9, 
  3.9068328719548235`*^9, 3.9068330659137936`*^9, 3.90683320982055*^9, 
  3.9068332985121384`*^9, 3.906834013236127*^9, 3.906834124185031*^9, 
  3.9068394620814734`*^9, 3.9068427868623996`*^9, 3.906843136116495*^9, 
  3.9068437468189116`*^9, 3.906844170814909*^9, 3.9068447734771585`*^9, 
  3.9068450752444086`*^9, 3.906896873267771*^9, 3.9068972642813187`*^9, 
  3.9068977810021124`*^9, 3.9068982383519306`*^9, 3.906987513557769*^9, 
  3.906988843560354*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[40]:=",ExpressionUUID->"e48406e0-abe6-459f-b34e-\
4f6142af7deb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:51c6\:5907\:5c31\:7eea", "\:ff0c", "\:5f00\:59cb\:8dd1\:51fd\:6570"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"result", ",", "resultplot"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"horizon", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"r", "/.", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], "-", 
           RowBox[{"2", 
            RowBox[{"m", "[", "r", "]"}], " ", "r"}], "+", " ", 
           SuperscriptBox["a", "2"]}], "==", "0"}], ",", "r", ",", "Reals"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pos", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "80", ",", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "2"}], "-", "0.01"}], ",", "0"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fov", "=", 
     RowBox[{"\[Pi]", "/", "5"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"npix", "=", "128"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"should", " ", "be", " ", "even"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"result", "=", 
     RowBox[{"TraceRay", "[", 
      RowBox[{"pos", ",", "fov", ",", "npix"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resultplot", "=", 
     RowBox[{"result", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", 
        RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.906832558595767*^9, 3.9068325706829414`*^9}, {
   3.906833387010518*^9, 3.9068333885473213`*^9}, {3.906833419933793*^9, 
   3.9068334308820043`*^9}, {3.906833463966186*^9, 3.9068334697820807`*^9}, {
   3.9068337613000712`*^9, 3.9068337731441565`*^9}, 3.906834056453969*^9, {
   3.9068423968017817`*^9, 3.9068423974101458`*^9}, {3.9068966791893225`*^9, 
   3.906896680401209*^9}, {3.9069791746706543`*^9, 3.9069791765424795`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"0f6cf7d7-2f7c-4b84-842a-54be6c71bc06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:9a8c\:8bc1\:4e00\:4e0b\:672b\:6001\:54c8\:5bc6\:987f\:91cf", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"icheck", "=", "10"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"\:68c0\:67e5\:70b9", 
     RowBox[{"(", 
      RowBox[{"icheck", ",", "icheck"}], ")"}], 
     "\:7684\:54c8\:5bc6\:987f\:91cf\:662f\:5426\:4e3a0"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"H", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"r", "\[Rule]", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"icheck", ",", "icheck", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"\[Theta]", "\[Rule]", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"icheck", ",", "icheck", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"qr", "\[Rule]", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"icheck", ",", "icheck", ",", "4"}], "]"}], "]"}]}], ",", 
        RowBox[{"q\[Theta]", "\[Rule]", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"icheck", ",", "icheck", ",", "5"}], "]"}], "]"}]}], ",", 
        RowBox[{"qt", "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"result", "[", 
           RowBox[{"[", 
            RowBox[{"icheck", ",", "icheck", ",", "6"}], "]"}], "]"}]}]}], 
        ",", 
        RowBox[{"q\[Phi]", "\[Rule]", 
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"icheck", ",", "icheck", ",", "7"}], "]"}], "]"}]}]}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "8"}], "]"}], "]"}], "]"}], ",", 
       " ", 
       RowBox[{"Max", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "9"}], "]"}], "]"}], "]"}], ",", 
       " ", 
       RowBox[{"Max", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "10"}], "]"}], "]"}], "]"}], ",", 
       " ", 
       RowBox[{"Max", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "11"}], "]"}], "]"}], "]"}], ",", 
       " ", 
       RowBox[{"Max", "[", 
        RowBox[{"result", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "12"}], "]"}], "]"}], "]"}]}], 
      "}"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.906842704472968*^9, 3.9068427064612427`*^9}, 
   3.9068430650545907`*^9, {3.906843680725996*^9, 3.906843680995567*^9}, {
   3.906844327861208*^9, 3.9068443451812572`*^9}, {3.9068445053405647`*^9, 
   3.9068445612664375`*^9}, {3.9069882859346924`*^9, 3.906988331844994*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"54ceea9e-cd04-4397-9f97-3b97e0fe169e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", "5.200786976633509`*^-7"}]], "Print",
 CellChangeTimes->{
  3.9068429113685637`*^9, 3.9068432674111557`*^9, 3.906843878340152*^9, {
   3.9068443155859823`*^9, 3.9068443460212965`*^9}, {3.906844507329685*^9, 
   3.90684456258206*^9}, 3.906844914013918*^9, 3.9068452126461706`*^9, 
   3.906896925548793*^9, 3.9068973135187902`*^9, 3.9068978161767845`*^9, 
   3.9068982785958624`*^9, 3.906988119423891*^9, 3.9069883337692194`*^9, 
   3.9069894029089665`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[62]:=",ExpressionUUID->"87693847-ca3a-4832-8fe0-\
6469938dc242"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0508700899279311`", ",", "0.0010688590693730465`", ",", 
   "0.0011827997087726935`", ",", "0.0005169896184344844`", ",", 
   "0.0007941737070496622`"}], "}"}]], "Print",
 CellChangeTimes->{
  3.9068429113685637`*^9, 3.9068432674111557`*^9, 3.906843878340152*^9, {
   3.9068443155859823`*^9, 3.9068443460212965`*^9}, {3.906844507329685*^9, 
   3.90684456258206*^9}, 3.906844914013918*^9, 3.9068452126461706`*^9, 
   3.906896925548793*^9, 3.9068973135187902`*^9, 3.9068978161767845`*^9, 
   3.9068982785958624`*^9, 3.906988119423891*^9, 3.9069883337692194`*^9, 
   3.9069894029159746`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[62]:=",ExpressionUUID->"e1d5c98b-7d8a-445c-801a-\
17c93b0653ce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"split", "=", 
   RowBox[{"\[Pi]", "/", "18"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetColor", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetClosestAngle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]0", ",", "\[Phi]0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pos", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"pos", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetClosestAngle", "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{"x", "/", "split"}], "]"}]}], "}"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q", "+", "1"}], ")"}], "split"}], "-", "x"}], ",", 
       RowBox[{"x", "-", 
        RowBox[{"q", " ", "split"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetColor", "[", 
    RowBox[{"{", 
     RowBox[{"rF_", ",", "\[Theta]Fx_", ",", "\[Phi]Fx_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]F", ",", "\[Phi]F"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rF", "<", 
         RowBox[{"3", " ", "horizon"}]}], ",", 
        RowBox[{"Return", "[", "Black", "]"}]}], "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\:6b64\:5904\:539f\:672c\:662frF", "<", 
         RowBox[{"1.1", " ", "horizon0"}]}], ",", 
        "\:4f46\:597d\:50cf\:8fdd\:53cd\:8fd9\:4e2a\:6761\:4ef6\:4e0d\:8db3\
\:4ee5\:4fdd\:8bc1\:5149\:5b50\:53ef\:4ee5\:51fa\:5c04"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]F", ",", "\[Phi]F"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"\[Theta]Fx", ",", "\[Phi]Fx"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]F", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]F", "-", "\[Phi]0"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]0", "]"}]}], 
           RowBox[{"Sin", "[", "\[Theta]F", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]F", "-", "\[Phi]0"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Theta]0", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]F", "]"}]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"theta", ",", "psi"}], "}"}], "=", 
       RowBox[{"WrapAngle", "[", 
        RowBox[{
         RowBox[{"ArcSin", "[", "n2", "]"}], ",", 
         RowBox[{"ArcSin", "[", "n1", "]"}]}], "]"}]}], ";", 
      RowBox[{
      "(*", "\:6ce8\:610ftheta\:548cpsi\:90fd\:662f\:7eac\:7ebf", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"GetClosestAngle", "[", "theta", "]"}], "\[LessEqual]", 
          "0.01"}], "||", 
         RowBox[{
          RowBox[{"GetClosestAngle", "[", "psi", "]"}], "\[LessEqual]", 
          "0.01"}]}], ",", 
        RowBox[{"Return", "[", "Black", "]"}], ",", 
        RowBox[{
         RowBox[{"n1", ">", "0"}], "&&", 
         RowBox[{"n2", ">", "0"}]}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"240", ",", "138", ",", "122"}], "}"}], "/", "255"}], 
         "]"}], 
        RowBox[{"(*", "red", "*)"}], ",", 
        RowBox[{
         RowBox[{"n1", ">", "0"}], "&&", 
         RowBox[{"n2", "<", "0"}]}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"62", ",", "55", ",", "129"}], "}"}], "/", "255"}], "]"}], 
        RowBox[{"(*", "blue", "*)"}], ",", 
        RowBox[{
         RowBox[{"n1", "<", "0"}], "&&", 
         RowBox[{"n2", "<", " ", "0"}]}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"225", ",", "227", ",", "76"}], "}"}], "/", "255"}], "]"}], 
        RowBox[{"(*", "yellow", "*)"}], ",", 
        RowBox[{
         RowBox[{"n1", "<", "0"}], "&&", 
         RowBox[{"n2", ">", "0"}]}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"77", ",", "178", ",", "71"}], "}"}], "/", "255"}], 
         "]"}]}], 
       RowBox[{"(*", "green", "*)"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixPlot", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"GetColor", ",", "resultplot", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], ",", 
    RowBox[{"DataReversed", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "False"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\:753bShadow", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", "<", 
         RowBox[{"3", "horizon"}]}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
     RowBox[{"resultplot", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<Monochrome\>\""}], ",", 
   RowBox[{"DataReversed", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8456900622759733`*^9, 3.8456900724365616`*^9}, {
   3.845691020763916*^9, 3.845691030304547*^9}, 3.8456913469557037`*^9, {
   3.845717416927682*^9, 3.8457174670097055`*^9}, {3.845717685774392*^9, 
   3.845717691288731*^9}, {3.8460776696804533`*^9, 3.84607775714038*^9}, {
   3.846077925542982*^9, 3.8460780392797003`*^9}, 3.8460781852985044`*^9, {
   3.8460782212507477`*^9, 3.846078243806916*^9}, 3.8460784394834375`*^9, {
   3.846078500906726*^9, 3.8460785713470984`*^9}, 3.8467206284256616`*^9, 
   3.846817830115274*^9, {3.846818745034588*^9, 3.846818771838665*^9}, {
   3.846818873591096*^9, 3.846818878858516*^9}, {3.8468193680168514`*^9, 
   3.8468193726676474`*^9}, {3.8468194845476437`*^9, 3.8468194985736513`*^9}, 
   3.8468196363711514`*^9, {3.8509592320720034`*^9, 3.8509592635117207`*^9}, {
   3.8509593202145014`*^9, 3.850959379249897*^9}, {3.8509602152294874`*^9, 
   3.850960328284079*^9}, {3.850962397410915*^9, 3.8509624335741105`*^9}, {
   3.8511324092393217`*^9, 3.851132409419551*^9}, {3.8515742082363033`*^9, 
   3.8515742253791313`*^9}, {3.851574355100346*^9, 3.8515743556314716`*^9}, {
   3.8515743949300337`*^9, 3.8515744826077414`*^9}, {3.8515745941097813`*^9, 
   3.8515746028892903`*^9}, {3.8515748594287558`*^9, 3.851574883489756*^9}, {
   3.851574921095216*^9, 3.8515749366958265`*^9}, 3.8517341429068713`*^9, {
   3.8517345100342517`*^9, 3.851734545555461*^9}, 3.8517347531634674`*^9, 
   3.8517348024835815`*^9, {3.8517348572787476`*^9, 3.8517348737581425`*^9}, {
   3.8517349733993053`*^9, 3.851735021376621*^9}, {3.851735054925974*^9, 
   3.85173505531669*^9}, {3.851735144963868*^9, 3.85173515070187*^9}, {
   3.8517352513331738`*^9, 3.8517352825516453`*^9}, {3.8517358590668426`*^9, 
   3.8517359323868113`*^9}, {3.851736521720796*^9, 3.8517365505882096`*^9}, {
   3.8517365942542152`*^9, 3.8517365979263754`*^9}, {3.851741999628358*^9, 
   3.8517420371405067`*^9}, {3.8524494129158306`*^9, 
   3.8524494189767804`*^9}, {3.8524497862501183`*^9, 3.852449811712927*^9}, {
   3.8524552756509666`*^9, 3.8524552761508904`*^9}, 3.8629440381747684`*^9, 
   3.8629471455604286`*^9, {3.862987965667733*^9, 3.8629879661856766`*^9}, {
   3.865034504468359*^9, 3.8650345060332623`*^9}, {3.9067410476798697`*^9, 
   3.906741068069453*^9}, {3.906744566163876*^9, 3.906744566855034*^9}, {
   3.9067908810131807`*^9, 3.906790881262951*^9}, {3.906795621469453*^9, 
   3.9067957221103296`*^9}, {3.906796772848242*^9, 3.906796785287649*^9}, 
   3.906796822649209*^9, {3.9068059417525196`*^9, 3.9068059647665877`*^9}, {
   3.9068070419993706`*^9, 3.90680705051836*^9}, 3.9068071505858345`*^9, {
   3.9068122678542023`*^9, 3.9068122782244654`*^9}, {3.9068338802521396`*^9, 
   3.9068339318923864`*^9}, {3.906834106406246*^9, 3.9068341073716555`*^9}, {
   3.906839269375005*^9, 3.90683929444071*^9}, {3.906839410484182*^9, 
   3.906839412483286*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"7b6139db-60b3-4aed-b1eb-718991ff4796"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztnE+qZEkZRwtcgnPFHbgAIdegggsQHLsBB+5D0QU5EO256MRR02uQeuXg
Ud3xuJEZcb/z++IcEOTQZMaNPxnnVmv97Le//9XvfvTp06c//v8/n//7L974
9vGHN759/PiNbx5d/aciaPOgr90PKdDWq6uvXudd/PSNvz/+/KfP/O3x8zf+
/dDX+up9QYe2Xqd51/0eT7sH0+9Z2vOm+93rlQJtXfTu8yvQ7jv9mV1Hg7Yu
Kd51Wetp92D6PUt73q7znAJtXfRMX71Pd0G77/Q9fPW+pkBbl/R1pz3vbk+7
B9PvU9o8pMxbFbT51/f21fv9bmj3nV5P6EwatPmnrQttHlZ52v2Ycs+e9rw0
aPOv13tOvw/tvtPrT+jVKrrOM21frfK0+zHlnk0ZJw3aPtHrO/0upUC7B/V6
sq8+r3dDmx/afljlafej9ywT2vrq9WRffV7p0O5Bvf4EX33uu0Fb31lPuze9
Z++Bto56fSdffb7p0O5BvV7ve8QstHWZ9bR70/v0Y2jrotef7Kt/D7pBux/1
er3vC6ugrYv34z3QukWv1/s7RoN2P+r1eo6v/n2isGo+ve+eg9Yner3ezu8K
rUP0ej3fV/9uSQa0DtHr9Xa+fAytN/R6Pd9X/25JDbQO0ev1dr6shdYber2e
76t/t06h6r6m9Yler7fz5R5ovaHX6zk+5fdn9zhHpN/jtG7R6/X2vDCh9Yle
r7f/Vz1X13uf9lx6/cl+1bkWIUPrGb1e73vByHftAVr/6PUn+N3nWqQTtM7R
6/X2f3on0LpIr0/0u8+piFyH1kV6/ck+/VyndwWtl/T6RL/qPIoIB1ov6fWd
fPr5Te8KWkfp9QS/+9yJSD9ofaXXk336eUzpEFpf6fUEv+p8pfCTN757/PKN
/zz++pfP/OtB89XzJHIHtB7T6wk+5Xyl9Amtu/R68nmpgtbhKb563URWQusx
vT6x/3efr5RuoXWaXk8+L6ugdbLe94X3/PqNbx6/eeO/j3/+441HV18937ug
9Zteb//75/x6PeFcrILWsXr7/z203u7qq9f5KrSu0+sJ7wWrxkPrHFq/6fX2
vD7FV+/Hq9B6WJ/1vkDrOr0+8d8L0PqH1nv6M/3ufT6C1pP6LF+1b2eh9a3e
9wW9vspX7fOqLqL1nv5Mv2o/z0LrRn1vX7XPaV2qZ/qq/UnrQP2Zvmo/2//6
E/yqfTuC1nt6vf2v7+p371taH+p7+6r9XNVLtD7U9/C79y2t6/Q9/O59mwKt
M/VZfvf+pHWjvrffvW93dxStD/U9/Kr9OYLWh/refZ4+/pR+o/Wqvsd7wQha
T+qz/O59aP/ryX7VPhxB60w9s+dp4+/a/7QOpI1f73uB/hy/e7/Z/3qCX7Xf
RtB6TG/PE/zsvNH6jdaHtPHrs94XaP2pZ/rd+3AWWk/qs/yqfUjrK709T/az
80zrMZp3Ps/0s+s+gtaZeqZftd9WQetJPdOv2m+0jtLb+Yl+dv5p3ZXunece
fvYczULrT739/x5aZ+p7dP4IWkfp7flEP7tetO7q6l2XHn52HWehdane/if0
p97O13O6kTb+dL/jrO2A1mPp3vnv4XectffQelXf472A1p96O1/P6Uza+J23
58aZ0kW0rnPe9L4X6O1/fSe/e1/R+k3/cR/Sxuk89Oj/3R1FGyetJ2nj1z+3
jiNovaq3//Ucv3v/0PpH37tvfd4z+39VX9HG6fOe6UfrtQpax+qZ7wW0XtXb
+fp+/7vxKmjrlb6OtI6idddufC/o7XfvH1rH6u/pf1qv6u1/PacbU55r9/xU
jXP3vNF6ZncX0bqO1oFd5y3d715fWsfq7X+9na+/p1dpnvZc6fM/Gmd659DG
n+Jn59n5Z/pV6ziC1rd6+/9kv+OMX4HWM139aetVNf7d30tbr9H30vpk9/dW
PS+tG3f3JO25uvpV6zULrXv1z70X0PpWX9v/tD5M96vmP329qsZPmzfaPKR3
fopPn4fZ8ac/b7qfPY+z0PpW/7Gnday+tvNH0Loxxe+eZ9frzD5f9Tl2GtOn
zP+qcY4+J2UeUvzsPK+C1r16+z/RV51fWo/RfNV8pqzXa7vvedLXd5WndQit
P6v6KuW5qsaZMg8pfnZ/roLWvXr7n+yrzimtW2ieNp+0ddw9Htrzrhrn9R3V
G1ov0XqVNm9V60ubh3Q/u46roPXwaZ7WvXr7n+yr5q1qHWc/P2VfrZrP2c+R
WtI7c3Y8VeM/7XvT/WjedkPr4dM8rXtP81XnbgSt02h92HU86c9bNT/Sg9O6
dPd4TnvedH/9pNwDrZO7eloPn+arz9nX0Dq8qjNp80MbT7p/7ZSI/DC0rqvq
ZNr8nLaO6f0/gtbP6Z7Ww1199bm5Cq3T7Oqs8c+OZ/f4r+98ketU9efucdLe
Ixyn/f8eWj+ne1onp/vq8/EqtL7t2snpz0Wbz1f3vcgKaP3W9Xurupc2ftr8
VEHr6hRP6+d0X30OXoXWt117dXffdp3P2XkQIdC1w2nzkD6fND+7vlXQujrF
0/o5xVfv913QujelS6vGv+p5q77XzpeTqerVVePZ/Vwp3Usb/2n9P4LW2zRP
62qar96/d0PrYfs/a/x2vsh1UnqP9t6RMj8p/vqO7QGtw+1/O58ArQ+79vPu
cabPg8jJ0Ho1ZZz2v/3/CrQ+t//t/Duh9WF633bt/1X7avZzRE4gpQ9TPr+q
k2njt/+fg9bt9r89fyen9XNXv3vdX9tlIvIMdiyzn2njtP/vgdb5Kf1fvW7y
w6R0rOO8Z5yr/nkRuc5pne847fwTSOn/6nkSFim92nWcKZ9/fUeJyCxVXZr+
+V3HeX3nyAmM+r96XNKT9K7uOs5V43l1f4jIfrp2rP1v54vImdA6P8Xvns87
94CIPAetn9P97DzfudYiIidD6/AUPzufd66piHwh5c+r0/2dayoiIjIi5X1B
RPZB6/87n11EROQ0aH+fWPV8iJzIqr/Hw7/HT0REOkHr5BQ/O593rqmIfIHW
/139nWsqIiLfh9bJKX73fN65B0TkOWhdne5n5/nOtRYRuZP0ju06zlXjeXV/
iMh+0v+9AG08tHG+uj/kbPz/9cgrpHds+jhTPv/6jhKRWaq6NP3zu47z+s6R
Exj9fR3+/VpyhdO62nF+PM5V/7yIXGd3B9rVZ45Taqn6+/po/e/7ApP0XtU/
1+G7P19EXue09wKaT5+313affA3t7+Xu2v++L6yF1qtd+3/3+Ks+f/Z7Zz9H
5ARS+jDl86s6mTZ++/85aN1u//tesANaJ9O6N2Wc6fMgcjK0rk4ZZ/p7EO25
ToPW5/a/7wV3QuvDrt3bdfz2v8h1Ujqw6p+n+fTx2/9foHW4/Z/lq/fvLmh9
eFo/z45/1fNWfa/vBXIy6R2+6nNo/voK9njeru8FtN6meVpXp/vq/f4qtB72
veC5Hu46n7PzIEKgqtNofUjrW9p80vzs+lZB6+oUT+vndF99Dl6F1r3pvdr1
uWjz+eq+F1kBrdO6fm9V39LGT5ufKmhdneJp/dzVV5+Pq9D69rSOTR//7Hh2
j//6zhe5TlVn7h7nae8FKeO0879A6+d0T+vk03z1efoaWt9W9SptfmjjSfev
nRKRH4bWdVU9TJuf09bR/tfb/3xffZ6+htZptD7sOp70562aH+lBSlenjOe0
503310/KPdA6uaun9bC+9r2A1uE0XzVvVes4+/kp+2rVfM5+jtSS3o2z46ka
/2nfm+5H87YbWg+f5mndq7f/yZ42n7R13D0e2vOuGuf1HdUbWhfR+pM2b1Xr
S5uHdD+7jqug9fBpnta9et8LEn3VfKas12u773nS13eVp/VG1w6c3Scpz1U1
zpR5SPGz+3MVtO7V2/+Jvur80nomxe+eZ9erdh1Tvnf0OXYX06fM/6pxjj4n
ZR5S/Ow8r4LWvfovfrRetO7V174X0Hos3a+a//T1qho/bd5o81DVG7ReSunn
lPGnP2+6nz2Ps9D6Vm//n+B3n+sRtJ7s6k9br6rx7/5e2nqNvpfWIem9XfW9
tG6kPVdXv2q9ZqH1rd7+P9nvPu+0bjzNn7ZetOdKn//RONN7hjb+FD87z84/
069axxG0jtU/1/kjaB2r971A779HmH2u3fNTNc7d80brlt39Q+s3Wu91nbd0
v3t9aR2rv6f/R9A6Vm//6+/v/67Q1it9HWm9ROur3ax6Xtq66O1/vf2v971A
z/nz8xR/2vPOzgOtc6o6ijZOn/dMP1qvVdB6VW//6zl+1f4ZQesivZ18wjyM
novWP/btPd1IG7/+uXUcQetSPbPzR9C6VG//6zn/OxPa+J2358aZ0jm0TnPe
9ITOH0HrVX1W/4+g9are9wK9fdvV7zhrO6D1Vbp3/nv4HWftPbQu1dv/+nP8
7v1G6zG97wWJfna9aB3V1bsuPfzsOs5C6099784fQetPPdOv2m+0jtLf05+0
8af72fmn9VW6d557+NlzNAutP/X2/3tonanP8qv2Ia2v9Pd0KW38KX52nmnd
RfPO55l+dt1H0DpTz/Sr9tvuHqN1pp7pV+23EbTu0td2LG38KfNG6y5a19HG
r2d2/ghaZ+qZftV+s//1ZL9qH46g9Zie2b208e9+3llonWbP6wk9P4LWk3qm
373f7H99ol+1P0fQ+k3fu5/Tx5/SY7T+1Nv5en3X/h9B60l9D79739K6VN/D
7963KdC6UZ/ld+9PWh/qe/vd+7aqr2jdqO/tV+3bEbSe1OsJ7xe0PtT38Lv3
La0D9b191X62//Un+1X7eRZaH+p7+6p9TutGPdNX7U9aB+rP9FX7mdZLtD7U
n+l37/MRtG7UZ/mqfTsLrT/1PXp+BK339PrE/t/dS7QO1OsJ7wUjaP2pt/+v
QOtVvT2v16d0/qpzQesiWu/p9YRzsQpar+p7d/4stO7t6qvX+Sq0ftPrCf2/
ajwpnUPrOr2efF5WQetefe/+n4XW1Xb7c9A6Ta8ndP7u85LSObR+0+vJ56UK
Wien+Op1E1kJrcf0evvf/tfrO/lV5ysFWrfb83IytO7S6wk+5Xyl9wmtx/R6
gt997kSkH7SO0uvJPv08pvcJrbv0+kS/6jyKCAdaL+n1nXz6+e3aG7S+0usT
/e5zKiLXofWPXn+yTz/XXbuC1lF6/Ql+97kW6QStZ/R6fb8/5x/5rv1Aey69
/mS/6lyLkKF1i16vt/9XPVd6J9C6SK/X+74gTGgdotfrOT2c8nuy+7lmqbr3
aZ2j1+t9X5B7oPWGXq/n+JTfn93j7AqtW/R6ve8FshZaV+j1er6v/t2SGmjd
otfrfS+Qj6H1g16v5/vq3y0K3o/PQesZvV7ve0FXaP2g1+v5vvp3i4736T3Q
Okev1/s7RoPWD3q9nuOrf58orJpP2j3r/fsxtHXR60/21b8H3aD1hl6vt9tX
QVsX2n3q/XsPtHXU6zv56vNNh3YP6vV6e34W2rrMetq96f3LhLa+ej3ZV59X
OrR7UK8/wVef+27Q1nfW0+7NlPs3ZZw0aPtEr+/0u5QC7R7U68m++rzeDW1+
aPthlafdjyn37GnPS4M2/3q95/T70O47vd5u30fXeabtq1Wedj+m37O0eUiZ
typo86/v7av3+93Q7ju9ntCTNGjzT1sX2jys8rT7Mf3+pT1v13lOgbYueqav
3qe7oN13+h6+el9ToK1L+rrTnne3p92D6fcs7XnT/e71SoG2Lnr3+RVo952+
d7+lQFuXFO+6rPW0e7DrPUubB33v7loFbb26+up13gXtvtPb4Vegrddp3nW/
x/8P1s3G0A==
   "], {{0, 0}, {128, 128}}, {0, 1}],
  AspectRatio->1,
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.906833890970566*^9, 3.906833916699511*^9}, 
   3.9068339484276543`*^9, 3.906834094712488*^9, 3.9068341598113337`*^9, 
   3.906839500061959*^9, 3.9068429116586905`*^9, 3.9068432676841516`*^9, 
   3.906843878623152*^9, 3.9068443157124276`*^9, 3.9068449142900333`*^9, 
   3.9068452129447565`*^9, 3.906896925825346*^9, 3.9068973137818146`*^9, 
   3.9068978162745867`*^9, 3.906898278847*^9, 3.906988120238552*^9, 
   3.9069894039156885`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"b48ce299-7d1d-417b-8c74-9a53df8d1dc1"],

Cell[BoxData[
 GraphicsBox[
  RasterBox[SparseArray[Automatic, {128, 128}, 1., {1, {CompressedData["
1:eJzVzyEKgwAARuF/ahsYBMEwGKsmwaYHsItZxQNoWFwSPIHJEwhLxt1Bl72A
B9jaYMl3DR98B3i3qknrk6RWx+6MCwIkKPHAgBdW/OAxGyNHixELvnANKUKB
Dk+88YFjSiEy3NFjwowNf9iWdIV/YDu3DRu+
      "], CompressedData["
1:eJxTTMoPSmJiYGDQYmFgYATSNrZ29g6OTs4urm6WVtZIPHcPTwsMES9vM3Ns
oj6mOMR9TXDK+BnjkfM3wisbQEDakIB8IEEFBgRVBFFHiT4RaoJHFQXTLUIo
TzuUpV28snjkcMrgEMcmiCGExAMAvLoQpQ==
      "]}, CompressedData["
1:eJztwTENACAQBLAjwcivyEECCTP+t9/R0LbO23ckWTMAAAAAAAAAAHwaovcB
2Q==
     "]}], {{0, 0}, {128, 128}}, {0, 1}],
  AspectRatio->1,
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {49.5, 
       FormBox["50", TraditionalForm]}, {99.5, 
       FormBox["100", TraditionalForm]}, {127.5, 
       FormBox["128", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.906833890970566*^9, 3.906833916699511*^9}, 
   3.9068339484276543`*^9, 3.906834094712488*^9, 3.9068341598113337`*^9, 
   3.906839500061959*^9, 3.9068429116586905`*^9, 3.9068432676841516`*^9, 
   3.906843878623152*^9, 3.9068443157124276`*^9, 3.9068449142900333`*^9, 
   3.9068452129447565`*^9, 3.906896925825346*^9, 3.9068973137818146`*^9, 
   3.9068978162745867`*^9, 3.906898278847*^9, 3.906988120238552*^9, 
   3.906989403968671*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"a78fea79-a8ba-4131-bbd5-cceedcce1fee"]
}, Open  ]]
},
WindowSize->{1069, 647},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (2023\:5e747\:670824\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a2092e24-86e2-43b8-bb2b-53c247fbd72b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 789, 18, 156, "Input",ExpressionUUID->"ceea9b0f-67c1-4788-9270-08c2bc1abb7f"],
Cell[CellGroupData[{
Cell[1372, 42, 35478, 998, 1704, "Input",ExpressionUUID->"13e6ae97-dbcb-4c58-945d-b8e0e5b9f81f"],
Cell[36853, 1042, 287, 5, 22, "Print",ExpressionUUID->"c468abbf-fd18-4f78-b80d-c59ad6e37485"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37177, 1052, 33635, 771, 2472, "Input",ExpressionUUID->"94f71393-03cf-4314-a6be-f5aa8a7a2156"],
Cell[70815, 1825, 750, 12, 22, "Print",ExpressionUUID->"e48406e0-abe6-459f-b34e-4f6142af7deb"]
}, Open  ]],
Cell[71580, 1840, 2099, 53, 211, "Input",ExpressionUUID->"0f6cf7d7-2f7c-4b84-842a-54be6c71bc06"],
Cell[CellGroupData[{
Cell[73704, 1897, 2985, 79, 171, "Input",ExpressionUUID->"54ceea9e-cd04-4397-9f97-3b97e0fe169e"],
Cell[CellGroupData[{
Cell[76714, 1980, 591, 11, 22, "Print",ExpressionUUID->"87693847-ca3a-4832-8fe0-6469938dc242"],
Cell[77308, 1993, 741, 15, 22, "Print",ExpressionUUID->"e1d5c98b-7d8a-445c-801a-17c93b0653ce"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78098, 2014, 8953, 208, 548, "Input",ExpressionUUID->"7b6139db-60b3-4aed-b1eb-718991ff4796"],
Cell[87054, 2224, 7975, 141, 365, "Output",ExpressionUUID->"b48ce299-7d1d-417b-8c74-9a53df8d1dc1"],
Cell[95032, 2367, 2598, 55, 387, "Output",ExpressionUUID->"a78fea79-a8ba-4131-bbd5-cceedcce1fee"]
}, Open  ]]
}
]
*)

